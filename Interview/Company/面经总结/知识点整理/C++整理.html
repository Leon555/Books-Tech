<html>
<head>
  <title>C++整理</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/272632; Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="3501"/>
<h1>C++整理</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div><div><b>一 面试题--C++ 面向对象思想 类型（类定义、特性、具体实例）</b></div><div style="color: rgb(51, 51, 51); text-align: left; background-color: rgb(214, 211, 214);"><span style="color: black;">类定义：</span></div><div style="color: rgb(51, 51, 51); text-align: left; background-color: rgb(214, 211, 214);"><div><b style="color: rgb(0, 0, 0); text-align: -webkit-auto;">“类”</b><span style="color: rgb(0, 0, 0); text-align: -webkit-auto;">是用户自定义的<b>具</b></span><b style="color: rgb(0, 0, 0); text-align: -webkit-auto;">有一定行为的数据类型</b><span style="color: rgb(0, 0, 0); text-align: -webkit-auto;">， 是</span><b style="color: rgb(0, 0, 0); text-align: -webkit-auto;">具有相同或相似行为的事物的抽象</b><span style="color: rgb(0, 0, 0); text-align: -webkit-auto;"> ；</span><b style="color: rgb(0, 0, 0); text-align: -webkit-auto;">“对象”</b><span style="color: rgb(0, 0, 0); text-align: -webkit-auto;">则是“类”这种数据类型的变量， 是一组具有相关性的代码和数据的组合体，是有一定责任的实体。</span></div><div><span style="color: rgb(0, 0, 0); text-align: -webkit-auto;">特性：</span></div><div><span style="color: rgb(0, 0, 0); text-align: -webkit-auto;"><b>基于对象和基于功能：</b></span></div></div><div style="text-align: left; background-color: rgb(214, 211, 214);"><span style="color: black;">面向对象可以理解成对待每一个问题，都是首先要确定这个</span><span style="color: red;">问题由几个部分组成</span><span style="color: black;">，而每一个部分其实就是一个对象类型。然后再分别设计这些</span><font color="#FF0000">类型</font><span style="color: black;">，最后得到整个程序。传统的程序设计多是基于功能的思想来进行考虑和设计的，而面向对象的程序设计则是基于对象的角度来考虑问题。这样做能够使得程序更加的简洁、清晰、可扩展、可维护。</span></div><div style="color: rgb(51, 51, 51); text-align: left; background-color: rgb(214, 211, 214);"><span style="color: black;"><br/></span></div><div style="color: rgb(51, 51, 51); text-align: left; background-color: rgb(214, 211, 214);"><span style="color: black;">可以想想 面向对象 与 过程化开发的区别，比如<b>开发一个选课系统</b>包括大专生、本科生、研究生等等。</span></div><div style="color: rgb(51, 51, 51); text-align: left; background-color: rgb(214, 211, 214);"><br/></div><div style="color: rgb(51, 51, 51); text-align: left; background-color: rgb(214, 211, 214); line-height: 23px;"><strong><span style="color: red;">个人认为</span>：可以从项目开发的角度（实践）或面向对象的三大特性（继承、封装、多态）三点入手谈认识。</strong></div><div><a href="http://blog.csdn.net/chenqin158741019/article/details/8149616">http://blog.csdn.net/chenqin158741019/article/details/8149616</a></div><div><b> </b></div><div>面向对象编程有<b>三个特性</b>：封装，继承，多态。这三个特性从<b>低级到高级</b>描述了面向对象的特征。一种语言只有<b>同时具备</b>这三种特性才能被称为面向对象的语言。</div><div><br/></div><div><b>封装：1 划分 2 暴露接口 3 隐藏内部细节</b></div><div>是所有抽象数据类型（ADT）的特性。将程序按照<b>一定的逻辑</b>分成多个互相协作的部分，并将 对外界有用的<b>稳定的</b>部分暴露出来，而将会发生的改变隐藏起来，外界只能通过暴露的部分向这个对象发送操作请求从而享受对象提供的服务，而不必管对象内部是 如何运行的，这就是封装。</div><div><br/></div><div><b>继承：1 复用 2 is-a关系</b></div><div>是<b>保持对象差异性的同时共享对象相似性的复用</b>。能够被继承的类总是含有并只含有它所抽象的那一类事务的共同特点。语义上的“继承”表示“是<b>一种（is-a）”的关系</b>。</div><div><br/></div><div><b>多态：1 对象行为的抽象 ，调用同名方法可以有不同的响应方式 </b></div><div>是“允许用户将父对象设置成为一个或更多的它的子对象相等的技术，赋值后，基类对象就可以根据当前赋值给它的派生类对象的特性以不同的方式运 作”（Charlie Calvert）。<b>多态是行为的抽象，它使得同名方法可以有不同的响应方式</b>，我们可以通过名字调用某 一方法而无需知道哪种实现将被执行，甚至无需知道执行这个实现的对象类型。</div><div><br/></div><div><span style="font-family:Microsoft YaHei; font-size:12px">多态的作用是什么呢，封装可以使得代码模块化，继承可以扩展已存在的代码，他们的目的都是为了代码重用。而<b>多态的目的则是为了接口重用</b>。也就是说，不论传递过来的究竟是那个类的对象，函数都能够通过同一个接口调用到适应各自对象的实现方法。</span></div><div><span style="font-family:Microsoft YaHei; font-size:12px"><br/></span></div><div>2 C++的空类有哪些成员函数</div><div>（1）缺省的构造函数</div><div><strong style="line-height: 26px; text-align: left; background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 0, 0);"><em>     默认构造函数指不带参数或者所有参数都有缺省值的构造函数!!!</em></span></strong></div><div>     初始化列表：<span style="background-color: rgb(255, 255, 255); line-height: 26px; text-align: left;">调用了类A的拷贝构造函数，从而将成员对象m_a 初始化。</span></div><div><br/></div><div>     构造函数体内：先暗地里创建m_a对象（调用了A 的无参数构造函数），再调用类A 的赋值函数，将参数a 赋给m_a。</div><div><br/></div><div><br/></div><div>（2）缺省的拷贝构造函数</div><div>     当类的对象需要拷贝的时候，该函数被调用。</div><div>           <span style="font-family: Verdana;">一个对象以值传递的方式传入函数体</span></div><font face="Verdana"><font face="Verdana">               一个对象以值传递的方式从函数返回<br/></font><font face="Verdana">               一个对象需要通过另外一个对象进行初始化。</font></font><div><font face="Verdana">     </font><a href="http://blog.csdn.net/lwbeyond/article/details/6202256">http://blog.csdn.net/lwbeyond/article/details/6202256</a> <font face="Verdana"><br/></font><div>（3）缺省的析构函数</div><div>（4）缺省的赋值运算符</div><div>     若一个类中包含：<b>内含引用成员</b> 或者 <b>内含const成员</b> 就必须定义自己的赋值操作符。以及后面的类中包含指针时，都跟该函数操作方式相关（<b>位拷贝，即不会去拷贝引用、指针指向的对象</b>）</div><div>     当基类将自己的默认赋值操作符声明为private时，子类就不会定义自己的默认赋值操作符。</div><div>（5）缺省取址运算符</div><div>（6）缺省取址运算符const</div><div>注意：后两个函数也是空类的默认函数。只有当实际使用这些函数的时候，编译器才会定义他们。</div><div><a href="http://blog.csdn.net/twlkyao/article/details/9104537">http://blog.csdn.net/twlkyao/article/details/9104537</a> </div><div>对这6个函数的一些解释：</div><div><p style="margin: 0px; padding: 0px; line-height: 26px; text-align: left; background-color: rgb(255, 255, 255);">&lt;1&gt;如果使用“缺省的无参数构造函数”和“缺省的析构函数”，等于放弃了自主“初始化”和“清除”的机会，C++发明人Stroustrup 的好心好意白费了。</p><div>&lt;2&gt;“缺省的拷贝构造函数”和“缺省的赋值函数”<b>均采用“位拷贝”而非“值拷贝”</b>的方式来实现，倘若类中含有指针变量，这两个函数注定将出错。</div><div><font face="SimSun">&lt;3&gt;拷贝构造函数与赋值重载操作符的区别：</font></div><div><font face="SimSun">     </font>（1）拷贝构造函数生成新的类对象，而赋值运算不能（功能上区别）</div><div>     （2）由于拷贝 构造函数是直接构造一个新的类对象，所以在初始化这个对象之前不用检验源对象是否和新建对象相同，而赋值运算符则需要这个操作，另外赋值运算符中如果原来的对象中内存非配要先把内存释放掉（功能上的区别导致的<b>实现上的区别</b>）</div><div>     注意：当类中 <b>有指针类型的成员变量时</b>，一定要重写拷贝构造函数和赋值运算符，不要使用默认的。</div><div><span style="font-family: SimSun;"><br/></span></div></div><div><span style="font-family: SimSun;">3 </span>简述类成员函数的重写，重载和隐藏的区别</div><div>重写：也叫覆盖，不同作用域（在父子关系类中）；声明方式一定相同；被重写的父类函数必须有virtual修饰</div><div>作用：基类指针和引用调用该方法时，根据对象类型实现动态绑定。</div><div><br/></div><div>重载：          在同一个类中；  声明方式一定不同；  virtual可有可无。（不同参数类型，不同参数个数。有无const）</div><div>作用：同一方法，根据传递信息的不同，执行不同的操作。</div><div><br/></div><div>隐藏：（不同的作用域中；函数名一定相同）</div><div>     隐藏和重写，重载有以下几点不同：</div><div>     <span style="background-color: rgb(255, 255, 255); color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; text-align: left;">一 声明不相同的情况：基类和派生类函数名相同，但是参数列表不同，不同有无virtual，基类函数在派生类中被隐藏，派生类只能调用新的方法，不能调用已被隐藏的基类方法（<b>不同于重载，作用域不同</b>）</span></div><p style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; text-align: left; background-color: rgb(255, 255, 255);">          二 声明相同的情况：基类与派生类同名，同参，<b>但基类函数无virtual</b>，同样派生类中同样隐藏基类的同名同参函数（<b>不同于覆盖，无virtual</b>）</p><div>覆盖是动态绑定的多态，而重载是静态绑定的多态</div><div><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; text-align: left; background-color: rgb(255, 255, 255);">覆盖进行动态绑定，根据基类指针或引用指向的对象类型，调用相应的方法</span></div><div><div><div>隐藏进行静态绑定，取决于 调用的指针或应用类型，而非 基类指针或引用指向的对象类型</div><p style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; text-align: left; background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 0, 0);">使用时，隐藏以产生混淆，应极力避免。</span></p></div><hr/></div><div><b>二 C++关键字</b></div><div>1  变量的声明和定义有什么区别</div><div><strong>本质：</strong>有没有分配内存</div><div>一个变量可以在多个地方声明，但只能在一个地方定义。</div><div>extern 修饰的是变量的声明，说明此变量将在文件以外或在文件后面部分定义</div><div><br clear="none"/></div><div>2  sizeof和strlen的区别</div><div><strong>定义：</strong>sizeof是一个操作符</div><div>             strlen是库函数</div><div><strong>本质：</strong></div><div><strong>作用：</strong>sizeof计算的是对象或着类型占内存的大小，而strlen计算的是字符串实际的长度；</div><div><strong>使用约束：</strong>sizeof的参数可以使数据的类型，也可以是变量，而strlen只能是以‘\0’为结尾的字符串作参数。</div><div><strong>其它：</strong>数组做sizeof的参数不退化，传递strlen就退化成为指针了。</div><div>          <b>编译器编译是就计算出了sizeof的结果，而strlen函数必须在运行时。</b></div><div>sizeof相关：<br clear="none"/></div><div>语法形式：<br clear="none"/></div><div>1) sizeof( object ); // sizeof( 对象 );<br clear="none"/>
2) sizeof( type_name ); // sizeof( 类型 );<br clear="none"/>
3) sizeof object; // sizeof 对象;</div><div>sizeof计算对象的大小也是转换成对对象类型的计算，也就是说，同种类型的不同对象其sizeof值都是一致的。</div><div>指针类型的sizeof 为指针的大小；数组类型的sizeof为整个数组占用的空间大小。数组作为函数参数时退化为指针。<br clear="none"/></div><div><br clear="none"/></div><div>3 C语言的关键字static和c++的关键字static有什么区别</div><div><strong>定义：</strong>在c中static用来修饰局部静态变量和外部静态变量，函数。而c++中除了上述功能外，还用来定义类的成员变量和函数，即静态成员变量和静态成员函数</div><div><strong>本质：</strong></div><div><strong>作用：</strong>编程时static的记忆性，和全局性的特点可以让在不同时期调用的函数进行通信，传递信息，而<b>c++的静态成员则可以在多个对象实例间进行通信，传递信息。</b></div><div><strong>使用约束：</strong></div><div><strong>其它：</strong></div><div><br clear="none"/></div><div>4 c中的malloc和c++中的new有什么区别</div><div><strong>定义：</strong><strike>new，delete是操作符，可以重载</strike>，只能在c++中使用。Malloc，free是函数，可以覆盖，c，c++中都可以使用。</div><div><strong>本质：</strong>New可以调用对象的构造函数，对应的delete调用相应的析构函数。Malloc仅仅分配内存，free仅仅回收内存，并不执行构造函数和析构函数。</div><div><strong>作用：</strong>malloc分配空间，new分配空间及初始化对象</div><div><strong>使用约束：</strong></div><div><strong>其它：</strong>malloc申请的内存空间要用free释放，而new申请的内存空间要用delete释放，不要混淆，因为两者实现的机理不同</div><div><br/></div><div><strong><br/></strong></div><div><strong>一 explicit</strong></div><div><strong><br/></strong></div><div><strong>按照默认规定，只有一个参数的构造函数也定义了一个隐式转换，将该构造函数对应数据类型的数据转换为该类对象，如下面所示：</strong></div><div>class String {</div><div>String ( const char* p ); // 用C风格的字符串p作为初始化值</div><div>//…</div><div>}</div><div>String s1 = “hello”; //OK 隐式转换，等价于String s1 = String（“hello”）;</div><div> </div><div><strong>但是有的时候可能会不需要这种隐式转换，如下：</strong></div><div>class String {</div><div>       String ( int n ); //本意是预先分配n个字节给字符串</div><div>String ( const char* p ); // 用C风格的字符串p作为初始化值</div><div>//…</div><div style="text-indent: 21pt;">}</div><div style="text-indent: 21pt;"> </div><div>下面两种写法比较正常：</div><div style="text-indent: 21pt;">String s2 ( 10 );   //OK 分配10个字节的空字符串</div><div style="text-indent: 21pt;">String s3 = String ( 10 ); //OK 分配10个字节的空字符串</div><div style="text-indent: 21pt;"> </div><div>下面两种写法就比较疑惑了：</div><div style="text-indent: 21pt;">String s4 = 10; //编译通过，也是分配10个字节的空字符串</div><div style="text-indent: 21pt;">String s5 = ‘a’; //编译通过，分配int（‘a’）个字节的空字符串</div><div style="text-indent: 21pt;"> </div><div><font color="#E30000">s4 和s5 分别把一个int型和char型，隐式转换成了分配若干字节的空字符串，容易令人误解。</font></div><div><font color="#E30000">为了避免这种错误的发生，我们可以声明显示的转换，使用<strong>explicit</strong> 关键字：</font></div><div>class String {</div><div>       <strong>explicit</strong> String ( int n ); //本意是预先分配n个字节给字符串</div><div>String ( const char* p ); // 用C风格的字符串p作为初始化值</div><div>//…</div><div style="text-indent: 21pt;">}</div><div>加上<strong>explicit</strong><strong>，</strong>就<b>抑制了String ( int n )的隐式转换</b>，</div><div> </div><div>下面两种写法仍然正确：</div><div style="text-indent: 21pt;">String s2 ( 10 );   //OK 分配10个字节的空字符串</div><div style="text-indent: 21pt;">String s3 = String ( 10 ); //OK 分配10个字节的空字符串</div><div style="text-indent: 21pt;"> </div><div>下面两种写法就不允许了：</div><div style="text-indent: 21pt;"><font color="#E30000">String s4 = 10; //编译不通过，不允许隐式的转换</font></div><div style="text-indent: 21pt;">String s5 = ‘a’; //编译不通过，不允许隐式的转换</div><div style="text-indent: 21pt;"> </div><div>因此，<font color="#E30000"><b>某些时候，explicit 可以有效得防止构造函数的隐式转换带来的错误或者误解</b></font><br/><br/>
----------------------------------------------------------<br/>
explicit   只对构造函数起作用，用来抑制隐式转换。如：  <br/>
  class   A   {  <br/>
          A(int   a);  <br/>
  };  <br/>
  int   Function(A   a);  <br/>
   <br/>
  当调用   Function(2)   的时候，2   会隐式转换为   A   类型。这种情况常常不是程序员想要的结果，所以，要避免之，就可以这样写：  <br/>
   <br/>
  class   A   {  <br/>
          explicit   A(int   a);  <br/>
  };  <br/>
  int   Function(A   a);  <br/>
   <br/>
  这样，当调用   Function(2)   的时候，编译器会给出错误信息（除非   Function   有个以   int   为参数的重载形式），这就避免了在程序员毫不知情的情况下出现错误。<br/><br/><font color="#FF1493">总结：explicit   只对构造函数起作用，用来抑制隐式转换。</font></div><div><font color="#FF1493"><br/></font></div><div><b>二 enum</b></div><div><p>1，枚举成员的作用域与枚举类型本身的<b>作用域相同</b>；</p><div>2，可以直接访问枚举成员，也可以通过枚举类型的作用域来访问对应类型的成员；</div></div><div><br/></div><div><p>1，枚举对象可用枚举成员或另一个枚举对象对其进行赋值；</p><p>2，不限定作用域的枚举没有默认类型，不能用其它基本类型的变量对其进行赋值，如以下的形式赋值都是错误的：</p><p><strike>Move m5 = 5;</strike></p><p><strike><span style="color: blue;">int</span> i =4;</strike></p><div><strike>Move m6 = i;</strike></div></div><div><p>3，<b>枚举成员是const的</b>，初始化枚举成员时提供的初始化值必须是常量表达式；</p><p>4，枚举成员本身就是常量表达式，因此，可在任可需要用到常量值的地方使用枚举成员；</p><div><h2><font size="3">限定作用域</font></h2><p>限定作用域的枚举类型，枚举成员作用域遵循常规的作用域准则，在枚举类型的作用域外不可访问；<b>不同的枚举类型可以定义相同名字的枚举成员，因为其在各自的作用域内。</b></p><p>【例8】枚举成员的访问</p><div><ol start="1"><li>enum class Move { left, right, up, down };  </li><li>Move m1 = Move::left;//通过枚举类型的作用域来访问  </li><li>//不可以直接访问枚举成员, 因为其在作用域外不可见  </li><li>//Move m2 = right; //提示： 'right' : undeclared identifier  </li><li>  </li><li>//Move中定义了left，在Direction中依然可以定义，互不冲突  </li><li>enum class Direction{ left, west, east};  </li><li>Direction d1 = Direction::left;  </li></ol></div><p><strong>笔记:</strong></p><p>1,iostream中的out没有实现对限定作用域的枚举类型，所有不能输出类似于枚举类型：<span style="color: navy;">cout</span> &lt;&lt; <span style="color: navy;">m1</span> &lt;&lt; <span style="color: rgb(136, 0, 0);">endl</span>;</p><p>【例9】指定数据类型</p><div><ol start="1"><li>enum class Move : long{ left =255, right, up, down};  </li><li>Move m1 = Move::left;  </li></ol></div><p><strong>笔记：</strong></p><p>1，限定作用域的枚举类型可以指定数据类型</p><p>2，如果没有指定类型，则枚举成员的默认类型是int</p></div></div><div><a href="http://blog.csdn.net/luoweifu/article/details/21742845">http://blog.csdn.net/luoweifu/article/details/21742845</a> </div><div><br/></div><div><br/></div><div><b>三 unoin</b></div><div><p>C++ union结构式一种特殊的类。它能够<b>包含访问权限、成员变量、成员函数（可以包含构造函数和析构函数）</b>。<u>它不能包含虚函数和静态数据变量。</u>它也不能被用作其他类的基类，它本身也不能有从某个基类派生而来。Union中得<b>默认访问权限是public</b>。</p><p>在C/C++程序的编写中，当多个基本数据类型或复合数据结构要<b>占用同一片内存</b>时，我们要使用联合体；当多种类型，多个对象，多个事物只取其一时（我们姑且通俗地称其为“n 选1”），我们也可以使用联合体来发挥其长处。</p><p>在某一时刻，一个union中只能有一个值是有效的。</p></div><div> union类型是共享内存的，以size最大的结构作为自己的大小。 在内存中的排列为声明的顺序x,y,z从低到高</div><div><p>union的一个用法就是可以用来测试CPU是大端模式还是小端模式：</p><div><div><b>[cpp]</b> <a href="http://blog.csdn.net/xiajun07061225/article/details/7295355#" title="view plain">view plain</a><a href="http://blog.csdn.net/xiajun07061225/article/details/7295355#" title="copy">copy</a><a href="http://blog.csdn.net/xiajun07061225/article/details/7295355#" title="print">print</a><a href="http://blog.csdn.net/xiajun07061225/article/details/7295355#" title="?">?</a></div><ol start="1"><li>#include &lt;iostream&gt;  </li><li>using namespace std;  </li><li>  </li><li>void checkCPU()  </li><li>{  </li><li>    union MyUnion{  </li><li>        int a;  </li><li>        char c;  </li><li>    }test;  </li><li>    test.a = 1;  </li><li>    if (test.c == 1)  </li><li>        cout &lt;&lt; &quot;little endian&quot; &lt;&lt;endl;  </li><li>    else cout &lt;&lt; &quot;big endian&quot; &lt;&lt;endl;  </li><li>}  </li><li>  </li><li>int main()  </li><li>{  </li><li>    checkCPU();  </li><li>    return 0;  </li><li>}  </li></ol></div></div><div><br/></div><div>四 namespace 对全局作用域的再次划分</div><div><a href="http://blog.csdn.net/yao_zhuang/article/details/1853625">http://blog.csdn.net/yao_zhuang/article/details/1853625</a></div><div><br/></div><div><hr/><div>1 写出 bool int float 指针变量与零值比较的if语句</div><div>Float 型数据：</div><div>#define NORM 0.00001;</div><div>if(flag&gt;=-NORM &amp;&amp; flag&lt;=NORM)</div><div><a href="http://www.360doc.com/content/12/0910/09/9305922_235299615.shtml">http://www.360doc.com/content/12/0910/09/9305922_235299615.shtml</a></div><div><br/></div><div><br/></div><div>2 一个指针可以使volatile吗</div><div>volatile：</div><div><b>定义：</b>编译器对访问该变量的代码就不再进行优化，使用 volatile 声明的变量的值的时候，系统总是<b>重新从它所在的内存读取数据</b>， volatile 可以保证对特殊地址的稳定访问。</div><div><b>作用：</b></div><div>1) 中断服务程序中修改的供其它程序检测的变量需要加volatile；</div><div>2) 多任务环境下各任务间共享的标志应该加volatile；</div><div>3) 存储器映射的硬件寄存器通常也要加volatile说明，因为每次对它的读写都可能由不同意义；</div><div>volatile指针：</div><div> 和 const 修饰词类似，const 有常量指针和指针常量的说法，volatile 也有相应的概念：</div><div>(1) 可以把一个非volatile int赋给volatile int，但是不能把非volatile对象赋给一个volatile对象。</div><div>(2) 除了基本类型外，对用户定义类型也可以用volatile类型进行修饰。</div><div>(3) C++中一个有volatile标识符的类只能访问它接口的子集，一个由类的实现者控制的子集。用户只能用const_cast来获得对类型接口的完全访问。此外，volatile向const一样会从类传递到它的成员。</div><div><a href="http://blog.csdn.net/tigerjibo/article/details/7427366">http://blog.csdn.net/tigerjibo/article/details/7427366</a> </div><div><a href="http://www.cnblogs.com/yc_sunniwell/archive/2010/07/14/1777432.html">http://www.cnblogs.com/yc_sunniwell/archive/2010/07/14/1777432.html</a></div><div><br/></div><div>3 a和&amp;a有什么区别</div><div>请写出以下代码的打印结果，主要目的是考察a和&amp;a的区别</div><div>#include&lt;stdio.h&gt;</div><div>oid main()</div><div>{</div><div>int a[5]={1,2,3,4,5};</div><div>int *ptr=(int *)(&amp;a+1);</div><div>printf(“%d,%d”,*(a+1),*(ptr-1));</div><div>return ;</div><div>}</div><div>输出结果：2,5</div><div>注意：<strong>数组名a可以作数组的首地址，而&amp;a是数组的指针。</strong></div><div><br/></div><div>4 简述strcpy，sprintf与memecpy的区别</div><div>（1）操作对象不同：strcpy的两个操作对象均为字符串，sprintf的操作对象可以是多种数据类型，目的操作对象是字符串，memcpy的两个对象是两个任意可操作的内存地址，并不限于何种数据类型。</div><div>（2） 执行功能不同：strcpy主要实现字符串变量间的拷贝，sprintf主要实现其他数据类型格式到字符串类型的转化，memcpy主要是内存块间的拷贝</div><div>（3）执行效率不同：memcpy最高，sprintf最低</div><div>说明：strcpy，sprintf，memcpy<b>都可以实现拷贝</b>的功能，但是<b>针对的对象不同</b>，根据实际需求，来选择合适的函数实现拷贝功能</div><div><br/></div><div><br/></div><div><font size="3"><strong><font face="Verdana"><span style="font-family: 宋体;">经典问题：</span> </font></strong></font><span lang="EN-US" style="font-family: Verdana;"><br/><font size="3">      double* (*a)[3][6]; <br/></font><font size="3">      cout&lt;&lt;sizeof(a)&lt;&lt;endl; // 4 a为指针<br/>
      cout&lt;&lt;sizeof(*a)&lt;&lt;endl; // 72 *a为一个有3*6个指针元素的数组<br/>
      cout&lt;&lt;sizeof(**a)&lt;&lt;endl; // 24 **a为数组一维的6个指针<br/>
      cout&lt;&lt;sizeof(***a)&lt;&lt;endl; // 4 ***a为一维的第一个指针<br/>
      cout&lt;&lt;sizeof(****a)&lt;&lt;endl; // 8 ****a为一个double变量</font></span></div><div><span lang="EN-US" style="font-family: Verdana;"><font size="3"><strong>问题解析：</strong>a</font></span><font size="3"><font face="Verdana"><span style="font-family: 宋体;">是一个很奇怪的定义，他表示一个指向</span><span lang="EN-US">double*[3][6]</span><span style="font-family: 宋体;">类型数组的指针。既然是指针，所以</span><span lang="EN-US">sizeof(a)</span><span style="font-family: 宋体;">就是</span><span lang="EN-US">4</span><span style="font-family: 宋体;">。</span> </font></font><span lang="EN-US" style="font-family: Verdana;"><br/><font size="3">      </font></span><font face="Verdana"><font size="3"><span style="font-family: 宋体;">既然</span><span lang="EN-US">a</span><span style="font-family: 宋体;">是执行</span><span lang="EN-US">double*[3][6]</span><span style="font-family: 宋体;">类型的指针，</span><span lang="EN-US">*a</span><span style="font-family: 宋体;">就表示一个</span><span lang="EN-US">double*[3][6]</span><span style="font-family: 宋体;">的多维数组类型，因此</span></font><font size="3"><span lang="EN-US">sizeof(*a)=3*6*sizeof(double*)=72</span><span style="font-family: 宋体;">。同样的，</span><span lang="EN-US">**a</span><span style="font-family: 宋体;">表示一个</span><span lang="EN-US">double*[6]</span><span style="font-family: 宋体;">类型的数组，所以</span><span lang="EN-US">sizeof(**a)=6*sizeof  (double*)=24</span><span style="font-family: 宋体;">。</span><span lang="EN-US">***a</span><span style="font-family: 宋体;">就表示其中的一个元素，也就是</span><span lang="EN-US">double*</span><span style="font-family: 宋体;">了，所以</span><span lang="EN-US">sizeof(***a)=4</span><span style="font-family: 宋体;">。至于</span><span lang="EN-US">****a</span><span style="font-family: 宋体;">，就是一个</span><span lang="EN-US">double</span><span style="font-family: 宋体;">了，所以</span><span lang="EN-US">sizeof(****a)=sizeof(double)=8</span></font><font size="3"><span style="font-family: 宋体;">。</span> </font></font><span lang="EN-US" style="font-family: Verdana;"><br/></span></div><div><a href="http://www.cnblogs.com/chengxin1982/archive/2009/01/13/1374575.html">http://www.cnblogs.com/chengxin1982/archive/2009/01/13/1374575.html</a> </div><div><br/></div></div></div></div><div style="line-height: 28px; text-align: left; background-color: rgb(214, 211, 214);"><div><font color="#0000FF"><br/></font></div><div><span style="color: blue;">静态链接库与动态链接库</span></div><div><span style="color: blue;">1 编译时&amp;运行时  2 多份拷贝&amp;只有一份</span></div><div><p style="word-break: normal; margin: 0cm 0cm 8pt; line-height: 14pt; text-indent: 0pt;"><span style="line-height: 14pt;"><font face="微软雅黑"><font color="#000000">二者的不同点在于<b>代码被载入的时刻不同</b>。</font></font></span></p><p style="word-break: normal; margin: 0cm 0cm 8pt 42pt; line-height: 14pt; text-indent: -21pt;"><font color="#000000"><span lang="EN-US" style="line-height: 14pt;"><span style="line-height: 14pt;"><font face="Wingdings"><font>l</font></font><span style="line-height: normal;"><font face="Times New Roman"><font> </font></font></span></span></span> <span style="line-height: 14pt;"><font face="微软雅黑"><font>静态库在程序<b>编译时</b>会被连接到目标代码中，程序运行时将不再需要该静态库，<b>因此体积较大</b>。</font></font></span></font></p><p style="word-break: normal; margin: 0cm 0cm 8pt 42pt; line-height: 14pt; text-indent: -21pt;"><font color="#000000"><span lang="EN-US" style="line-height: 14pt;"><span style="line-height: 14pt;"><font face="Wingdings"><font>l</font></font><span style="line-height: normal;"><font face="Times New Roman"><font> </font></font></span></span></span> <span style="line-height: 14pt;"><font face="微软雅黑"><font>动态库在程序编译时并不会被连接到目标代码中，而是在程序<b>运行</b>是才被载入，因此在程序运行时还需要动态库存在，<b>因此代码体积较小</b>。</font></font></span></font></p><div><font color="#000000"><span style="line-height: 14pt;"><font face="微软雅黑"><font>动态库的好处是，不同的应用程序如果调用相同的库，那么在内存里<b>只需要有一份</b>该共享库的实例。带来好处的同时，也会有问题！如经典的</font></font></span><font><span lang="EN-US" style="line-height: 14pt;"><font face="Calibri">DLL Hell</font></span></font><span style="line-height: 14pt;"><font face="微软雅黑"><font>问题，关于如何规避动态库管理问题，可以自行查找相关资料。</font></font></span></font></div></div><div><font color="#000000"><span style="line-height: 14pt;"><font face="微软雅黑"><font><br/></font></font></span></font></div><div><p style="margin: 0px 0px 14px;"><span style="font-family: 楷体;"><b>静态库与导入库的区别：</b></span><br/><span style="font-family: 楷体;">导入库和静态库的区别很大，他们实质是不一样的东西。静态库本身就包含了实际执行代码、符号表等等，而对于<b>导入库而言</b>，其实际的执行代码位于动态库中，<b>导入库只包含了</b></span><span style="font-family: 楷体;"><b>地址符号表</b>等，确保程序找到对应函数的一些基本地址信息。</span></p></div><div><a href="http://www.cnblogs.com/skynet/p/3372855.html">http://www.cnblogs.com/skynet/p/3372855.html</a> </div><div><b>静态链接与动态链接：</b></div><div><p style="margin: 0px 0px 14px;"><span style="font-family: 楷体;">静态链接：静态链接的时候，载入代码就会把程序会用到的动态代码或动态代码的地址确定下来</span>，<span style="font-family: 楷体;">静态库的链接可以使用静态链接，<b><font color="#FF0000">动态链接库也可以使用这种方法链接导入库</font></b></span></p></div><div><span style="font-family: 楷体;">动态链接：使用这种方式的程序并不在一开始就完成动态链接，而是直到<b>真正调用动态库代码时</b>，载入程序才计算(被调用的那部分)动态代码的逻辑地址，然后等到某个时候，程序又需要调用另外某块动态代码时，载入程 序又去计算这部分代码的逻辑地址，所以，这种方式使程序初始化时间较短，但运行期间的性能比不上静态链接的程序。</span></div><div><span style="font-family: 楷体;"><br/></span></div><div><a href="http://blog.csdn.net/zzhongcy/article/details/38320217">http://blog.csdn.net/zzhongcy/article/details/38320217</a> c与C++库互相调用</div><div>C++中调用C：头文件放入 extern &quot;C&quot;{   }中</div><div>C中调用C++的dll库函数：C中不能识别类，所以要将上面类的成员函数封装成C接口函数才能被调用。</div><div><br/></div><div>多线程中fork进程：子进程中只会复制调用线程。</div><div><a href="http://xorcerer.iteye.com/blog/1409958">http://xorcerer.iteye.com/blog/1409958</a></div><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: blue;"><span style="font-family: 宋体;">面试题11</span></span>：设置地址为0x67a9的整型变量的值为0xaa66</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">int *ptr;</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">ptr = (int *)0x67a9;</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">*ptr = 0xaa66;</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">说明：这道题就是强制类型转换的典型例子，无论在什么平台地址长度和整型数据的长度是一样的，即一个整型数据可以强制转换成地址指针类型，<span style="color: red;">只要有意义即可</span>。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">但是，此处的转换，编译没有问题，但是运行的时候可能会出错。因为Ox67a9这块地址可能被占用……</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: blue;"><span style="font-family: 宋体;">面试题14</span></span>：谈谈你对拷贝构造函数和赋值运算符的认识</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">拷贝构造函数和赋值运算符重载有以下两个不同之处：</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">（1）拷贝构造函数生成新的类对象，而赋值运算符不能。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">（2）由于拷贝构造函数是直接构造一个新的类对象，所以在初始化这个对象之前不用<span style="color: red;">检验源对象是否和新建对象相同</span>。而赋值运算符则需要这个操作，另外赋值运算中如果原来的对象中有内存分配要<span style="color: red;">先把内存释放掉</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">注意：<span style="color: red;">当有类中有指针类型的成员变量时，一定要重写</span>拷贝构造函数和赋值运算符，不要使用默认的。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: blue;">面试题15</span>：用C++设计一个不能被继承的类</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">class A</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">{</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><b>private:</b></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><b>A() {}</b></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><b>~A() {}</b></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">};</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">注意：构造函数是继承实现的关键，每次子类对象构造时，首先调用的是父类的构造函数，然后才是自己的。</p><div style="color: rgb(51, 51, 51);">此处，如果将<span style="color: red;">父类构造函数写成私有的</span>，便不能完成继承操作。这是考察点。</div></div><div style="text-align: left; background-color: rgb(214, 211, 214);"><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">18</span><span style="color: blue;">：简述多态实现的原理（1 虚表 2 每个对象里的虚指针（在构造函数里实现关联））</span></strong></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">编译器发现一个类中有虚函数，便会立即为此类生成<span style="background-color: yellow;">虚函数表</span><span style="background-color: yellow;"> vtable</span><span style="background-color: yellow;">。</span>虚函数表的各表项为指向对应虚函数的指针。<span style="color: red;">编译器还会在此类中隐含插入一个指针</span><span style="color: red;">vptr</span><span style="color: red;">（对</span><span style="color: red;">vc</span><span style="color: red;">编译器来说，它插在类的第一个位置上</span>）指向虚函数表。调用此类的构造函数时，在类的构造函数中，编译器会隐含执行vptr与vtable的关联代码，将vptr指向对应的vtable，将类与此类的vtable联系了起来。另外在调用类的构造函数时，指向基础类的指针此时已经变成指向具体的类的this指针，这样依靠此this指针即可得到正确的vtable。如此才能真正与函数体进行连接，这就是<span style="color: red;">动态联编</span>，实现多态的基本原理。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>注意：一定要区分虚函数，纯虚函数、虚拟继承的关系和区别。牢记虚函数实现原理，因为多态C++面试的重要考点之一，而虚函数是实现多态的基础。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">19</span><span style="color: blue;">：链表和数组有什么区别（1 存储 2 操作 3 越界）</span></strong></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">数组和链表有以下几点不同：</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">（1）存储形式：数组是一块连续的空间，声明时就要确定长度。链表是一块可<span style="color: red;">不连续</span>的动态空间，长度可变，每个结点要保存相邻结点指针。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">（2）数据查找：数组的线性查找速度快，查找操作直接使用偏移地址。链表需要按顺序检索结点，效率低。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">（3）数据插入或删除：链表可以快速插入和删除结点，而数组则可能需要大量数据移动。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">（4）越界问题：<span style="color: red;">链表不存在越界</span>问题，数组有越界问题。</p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>说明：在选择数组或链表数据结构时，一定要根据实际需要进行选择。数组便于查询，链表便于插入删除。数组节省空间但是长度固定，链表虽然变长但是占了更多的存储空间。</strong></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"> </p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;"> 21</span><span style="color: blue;">：简述队列和栈的异同</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">队列和栈都是线性存储结构，但是两者的插入和删除数据的操作不同，</span><span style="color: red;">队列是</span><span style="color: red;">“</span><span style="color: red;">先进先出</span><span style="color: red;">”</span><span style="color: red;">，栈是</span><span style="color: red;">“</span><span style="color: red;">后进先出</span><span style="color: red;">”</span><span style="color: red;">。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>注意：区别栈区和堆区。<span style="background-color: yellow;">堆区的存取是顺序随意</span>，<span style="background-color: yellow;">而栈区是后进先出</span>。栈由编译器自动分配释放 ，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈。堆一般由程序员分配释放， 若程序员不释放，程序结束时可能由OS回收。分配方式类似于链表。</strong></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>它与本题中的堆和栈是两回事。堆栈只是一种数据结构，而堆区和栈区是程序的不同内存存储区域。在面试题9有讲述。</strong></p><p style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"> </p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">32</span><span style="color: blue;">：</span><span style="color: blue;">C++</span><span style="color: blue;">的引用和</span><span style="color: blue;">C</span><span style="color: blue;">语言的指针有什么区别（1定义 2初始化、可变性、空）</span></strong></p><div style="color: rgb(51, 51, 51);"><span style="color: black;">定义：</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">指针：存放对象地址的<b>一个变量</b>。逻辑上独立。</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">引用：一个变量的<b>别名</b>。逻辑上不独立。</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;"><br/></span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">指针和引用主要有以下区别：<b>是否开始要初始化、是否可改变、是否可为空。</b></span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">不可改变的本质：编译时期，</span><b style="text-align: -webkit-auto;">指针变量在符号表上对应的地址值为指针变量的地址值，而引用在符号表上对应的地址值为引用对象的地址值。</b><span style="text-align: -webkit-auto;"><b>符号表生成后就不会再改</b>，因此指针可以改变指向的对象（指针变量中的值可以改），而引用对象不能改。</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;"><br/></span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;"><b>两个地方使用引用</b>：</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">1、<b>当你一开始就知道指向某物，且绝不会改变</b>。</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">2、实现一个操作符，用指针无法满足要求时，如vector的下标操作[] <b>希望能够返回一个可以赋值的左值</b>。</span><span style="color: black;">使用引用可能会比使用指针更有效率，因为引用在使用之前不需要测试有效性。</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;"><br/></span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;"><b>指针参数与引用参数传递的区别：</b>指针参数的<b>本质上还是值传递</b>。函数内操作的是实参的<b>一份指针拷贝</b>。对指针本身进行操作，不会影响原来的指针。</span></div><p align="left" style="font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><br/></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">35</span><span style="color: blue;">：</span><span style="color: blue;">typedef</span><span style="color: blue;">和</span><span style="color: blue;">define</span><span style="color: blue;">有什么区别（1作用 2）</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">（</span><span style="color: black;">1</span><span style="color: black;">）用法不同：</span><span style="color: black;">typedef</span><span style="color: black;">用来定义一种数据类型的别名，增强程序的可读性。</span><span style="color: black;">define</span><span style="color: black;">主要用来定义常量，以及书写复杂使用频繁的宏。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">（</span><span style="color: black;">2</span><span style="color: black;">）执行时间不同：</span><span style="color: red;">typedef</span><span style="color: black;">是编译过程的一部分，</span><span style="color: red;">有类型检查的功能</span><span style="color: black;">。</span><span style="color: black;">define</span><span style="color: black;">是宏定义，是预编译的部分，其发生在编译之前，只是简单的进行字符串的替换，不进行类型的检查。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">（</span><span style="color: black;">3</span><span style="color: black;">）作用域不同：</span><span style="color: black;">typedef</span><span style="color: red;">有作用域限定</span><span style="color: black;">。</span><span style="color: black;">define</span><span style="color: black;">不受作用域约束，只要是在</span><span style="color: black;">define</span><span style="color: black;">声明后的引用都是正确的。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">（</span><span style="color: black;">4</span><span style="color: black;">）对指针的操作不同：</span><span style="color: black;">typedef</span><span style="color: black;">和</span><span style="color: black;">define</span><span style="color: black;">定义的指针时有很大的区别。</span></p><div style="color: rgb(51, 51, 51);"><strong>注意：typedef定义是语句，因为句尾要加上分号。而define不是语句，千万不能在句尾加分号。</strong></div><div style="color: rgb(51, 51, 51);"><strong><br/></strong></div><div><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">36</span><span style="color: blue;">：关键字</span><span style="color: blue;">const</span><span style="color: blue;">是什么</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">const</span><span style="color: black;">用来定义一个</span><span style="color: red;">只读</span><span style="color: black;">(</span><span style="color: black;">不能修改其值</span><span style="color: black;">)</span><span style="color: black;">的变量或对象。主要优点：</span><span style="color: red;">便于类型检查</span><span style="color: black;">、同宏定义一样可以方便地进行参数的修改和调整、节省空间，避免不必要的内存分配、可为函数重载提供参考。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">const </span><span style="color: black;">应用表现在：常量定义；类的成员变量为常量；类的成员函数为常量（表示该函数不能修改成员变量的值）；函数传递的时候参数为常量。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>说明：const修饰函数参数，是一种编程规范的要求，便于阅读，一看即知这个参数不能被改变，实现时不易出错。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong> </strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">37</span><span style="color: blue;">：</span><span style="color: blue;">static</span><span style="color: blue;">有什么作用</span></strong></p><div style="color: rgb(51, 51, 51);"><span style="color: black;">在C中：主要是 <b>限定作用域</b> 和 <b>扩展生存期</b>。</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">在C++中：指示变量/函数在<b>该类中的 唯一性</b> ，即它是属于类的，而不是属于某个具体对象。static函数没有this指针，依赖this指针的所有操作将对static函数无效。</span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;"><br/></span></div><div style="color: rgb(51, 51, 51);"><span style="color: black;">static</span><span style="color: black;">在</span><span style="color: black;">C</span><span style="color: black;">中主要用于定义全局静态变量、定义局部静态变量、定义静态函数。在</span><span style="color: black;">C++</span><span style="color: black;">中新增了两种作用：</span><span style="color: red;">定义静态数据成员、静态函数成员</span><span style="color: black;">。</span></div><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>注意：因为static定义的变量分配在静态区，所以其定义的变量的<span style="color: red;">默认值为</span><span style="color: red;">0</span>，普通变量的默认值为随机数，在定义指针变量时要特别注意。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">40</span><span style="color: blue;">：简述指针常量与常量指针区别</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">指针常量是指定义了一个</span><span style="color: red;">指针</span><span style="color: black;">，这个指针的值只能在定义时初始化，其他地方不能改变。常量指针是指定义了一个指针，这个指针指向一个只读的对象，不能通过常量指针来改变这个对象的值。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">指针常量强调的是指针的</span><span style="color: red;">不可改变性</span><span style="color: black;">，而常量指针强调的是指针对其所指对象的不可改变性。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>注意：无论是指针常量还是常量指针，其最大的用途就是作为函数的形式参数，保证实参在被调用函数中的不可改变特性。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">41</span><span style="color: blue;">：数组名和指针的区别</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">请写出以下代码的打印结果：</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">void main(void)</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">{</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       charstr[13]=&quot;Hello world!&quot;;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       char*pStr=&quot;Hello world!&quot;;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"> </p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       cout&lt;&lt;sizeof(str)&lt;&lt;endl;  //13</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       cout&lt;&lt;sizeof(pStr)&lt;&lt;endl;//4</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       cout&lt;&lt;strlen(str)&lt;&lt;endl;  //12</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       cout&lt;&lt;strlen(pStr)&lt;&lt;endl;//12</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"> </p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       return;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">}</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>注意：一定要记得<span style="color: red;">数组名并不是真正意义上的指针，它的内涵要比指针丰富的多</span>。但是当数组名当做参数传递给函数后，其失去原来的含义，变作普通的指针。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>另外要注意<span style="background-color: yellow;">sizeof</span><span style="background-color: yellow;">不是函数，只是操作符</span>。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong> </strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">42</span><span style="color: blue;">：如何避免</span><span style="color: blue;">“</span><span style="color: blue;">野指针</span><span style="color: blue;">”</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">“</span><span style="color: black;">野指针</span><span style="color: black;">”</span><span style="color: black;">产生原因及解决办法如下：</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">（</span><span style="color: black;">1</span><span style="color: black;">）指针变量声明时没有被初始化。解决办法：指针</span><span style="color: red;">声明时初始化</span><span style="color: black;">，可以是具体的地址值，也可让它指向</span><span style="color: black;">NULL</span><span style="color: black;">。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">（</span><span style="color: black;">2</span><span style="color: black;">）指针</span><span style="color: black;">p </span><span style="color: black;">被 </span><span style="color: black;">free</span><span style="color: black;">或者</span><span style="color: black;">delete</span><span style="color: black;">之后，没有置为</span><span style="color: black;">NULL</span><span style="color: black;">。解决办法：指针指向的内存空间</span><span style="color: red;">被释放后指针应该指向</span><span style="color: red;">NULL</span><span style="color: black;">。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">（</span><span style="color: black;">3</span><span style="color: black;">）指针操作超越了变量的作用范围。解决办法：在变量的作用域结束前释放掉变量的地址空间并且让指针指向</span><span style="color: black;">NULL</span><span style="color: black;">。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>注意：“野指针”的解决方法也是<span style="background-color: yellow;">编程规范</span>的基本原则，平时使用指针时一定要避免产生“野指针”，在使用指针前一定要检验指针的合法性。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong> </strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">43</span><span style="color: blue;">：常引用有什么作用</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">常引用的引入主要是为了避免<b>使用变量的引用时，在不知情的情况下改变变量的值</b>。常引用主要用于定义一个普通变量的<b>只读属性的</b></span><span style="color: red;"><b>别名</b></span><span style="color: black;">、作为函数的传入形参，</span><span style="color: red;">避免实参在调用函数中被意外的改变</span><span style="color: black;">。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>说明：很多情况下，需要用常引用做形参，被引用对象等效于常对象，不能在函数中改变实参的值，这样的好处是有较高的<span style="color: red;">易读性和较小的出错率</span>。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">voidmain(void)</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">{</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       int ival = 58;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       void refFun(const int&amp; xval);</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       refFun(ival);</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       cout &lt;&lt; ival &lt;&lt; endl; //不加const会返回59,加const会报错!</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       return;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">}</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"> </p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">voidrefFun(const int&amp; xval)</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">{</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       xval = xval +1; //l-value specifies constobject[报错]</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">}</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong><span style="color: blue;">面试题</span><span style="color: blue;">49</span><span style="color: blue;">：构造函数能否为虚函数</span></strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">构造函数不能是虚函数，但是编译能通过。</span><span style="color: red;">而且不能在构造函数中调用虚函数</span><span style="color: black;">，因为那样实际执行的是父类的对应函数，因为自己还没有构造好。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><span style="color: black;">析构函数可以是虚函数，而且，在一个复杂类结构中，这往往是必须的。析构函数也可以是纯虚函数，但</span><span style="color: red;">纯虚析构函数必须有定义体</span><span style="color: black;">，因为析构函数的调用是在子类中隐含的。</span></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"><strong>说明：虚函数的动态绑定特性是实现重载的关键技术，<span style="color: red;">动态绑定根据实际的调用情况查询相应类的虚函数表</span>，调用相应的虚函数。</strong></p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">class Base</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">{</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">public:</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">//     virtual Base(){} //会报错：'inline' isthe only legal storage class for constructors</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       virtual ~Base(){}</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">};</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"> </p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">int main()</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">{</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       Base objB;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       cout &lt;&lt; endl;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">       return 0;</p><p align="left" style="color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">}</p><p align="left" style="font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);"> 1 什么是线程安全?线程安全是怎么完成的(原理)?<br/>
线程安全就是说多线程访问同一代码，<b>不会产生不确定的结果</b>。编写线程安全的代码是依靠线程同步。</p></div></div><div><b>2 </b><span style="background-color: rgb(255, 255, 255); color: rgb(68, 68, 68); font-family: 微软雅黑; line-height: 24px;">关于内存对齐的问题以及sizof()的输出</span><span style="background-color: rgb(255, 255, 255); color: rgb(68, 68, 68); font-family: 微软雅黑; line-height: 24px;"> </span></div><span style="color: rgb(68, 68, 68); font-family: 微软雅黑; line-height: 24px; background-color: rgb(255, 255, 255);">答：编译器自动对齐的原因：为了提高程序的性能，数据结构（尤其是栈）应该尽可能</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑; line-height: 24px; background-color: rgb(255, 255, 255);"/><span style="color: rgb(68, 68, 68); font-family: 微软雅黑; line-height: 24px; background-color: rgb(255, 255, 255);">地在自然边界上对齐。原因在于，为了访问未对齐的内存，处理器需要作两次内存访问</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑; line-height: 24px; background-color: rgb(255, 255, 255);"/><span style="color: rgb(68, 68, 68); font-family: 微软雅黑; line-height: 24px; background-color: rgb(255, 255, 255);">；然而，对齐的内存访问仅需要一次访问。</span><div><font color="#444444" face="微软雅黑"><span style="line-height: 24px;"><br/></span></font><div><font color="#444444" face="微软雅黑"><span style="line-height: 24px;"><b>3 c/c++内存分配</b></span></font></div><div>void main()
<div>{</div><div>    int b; //栈</div><div>    char s[] = &quot;abc&quot;; <b>//s在栈中，“abc&quot;在常量区。进行s[0] =‘A’时，则会在堆里开辟一个一样的字符串。</b></div><div>    char *p2; //栈</div><div>    char *p3 = &quot;123456&quot;; //123456{post.content}在<b>常量区</b>，p3在栈上</div><div>    static int c = 0; //全局（静态）初始化区</div><div>    p1 = (char *)malloc(10); //分配得来得10字节的区域在堆区</div><div>    p2 = (char *)malloc(20); //分配得来得20字节的区域在堆区</div><div>    strcpy(p1, &quot;123456&quot;);</div><div>    //123456{post.content}放在常量区<b>，</b>编译器可能会将它与p3所指向的&quot;123456&quot;优化成一块</div><div>}</div><div>（1）<strong> 在c中分为这几个存储区</strong></div><div>1.栈 - 由<strong>编译器</strong>自动分配释放==&gt;自动变量 每次函数调用时所需保存的信息（返回地                                                                            址，调用者环境信息）</div><div>2.堆 - 一般由<strong>程序员</strong>分配释放，若程序员不释放，程序结束时可能由OS回收</div><div>3.<b>全局区（静态区）</b>，全局变量和静态变量的存储是放在一块的，<b>初始化的</b>全局变量和静态变量在一块区域，<b>未初始化的</b>全局变量和未初始化的静态变量在相邻的另一块区域。- 程序结束释放</div><div>4.另外还有一个专门放<b>常量区</b>的地方。- 程序结束释放</div><div>5 <b>程序代码区</b>，存放2进制代码。</div><div><br/></div><div>（2）<strong> </strong>在C++中分为几个存储区</div><div><b>栈</b>：栈内存分配运算内置于处理器的指令集中，效率高，但分配的内存容量有限。</div><div><b>堆</b>：由new分配的内存块，应用程序自己控制。如果程序员没有释放掉，<strong>那么在程序结束后</strong>,操作系统会自动回收。</div><div><b>自由存储区</b>：由malloc等分配的内存块。</div><div><b>全局、静态存储区</b>：它们分到同一块内存中，在Ｃ语言中全局变量又分初始化和未初始化的，但在Ｃ＋＋中没有这个区分。</div><div><b>常量存储区</b>：存放常量，不允许修改。</div><div><b>程序区：</b></div><div><b><br/></b></div><div><div>C、C++中内存分配方式可以分为三种：</div><div>（1）从静态存储区域分配：</div><div><br/></div><div>内存在程序编译时就已经分配好，这块内存在程序的<span style="color: red;">整个运行期间都存在</span>。速度快、不容易出错，因为有系统会善后。例如全局变量，static变量等。</div><div>（2）在栈上分配：</div><div><br/></div><div>在执行函数时，<span style="color: red;">函数内局部变量</span>的存储单元都在栈上创建，函数执行结束时这些存储单元自动被释放。栈内存分配运算内置于处理器的指令集中，效率很高，但是<span style="color: red;">分配的内存容量有限</span>。</div><div>（3）从堆上分配：</div><p style="text-align: left; color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">即动态内存分配。程序在运行的时候用malloc或new申请任意大小的内存，程序员自己负责在何时用free或delete释放内存。动态内存的生存期由程序员决定，使用非常灵活。如果在堆上分配了空间，就有责任回收它，否则运行的程序会出现内存泄漏，另外频繁地分配和释放不同大小的堆空间将会产生堆内碎块。</p><p style="text-align: left; color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; background-color: rgb(255, 255, 255);">一个C、C++程序编译时内存分为5大存储区：堆区、栈区、全局/静态区、文字常量（字符常量）区、程序代码区。</p></div><div><b>常见内存分配错误（申请时、使用时（未初始化、越界）、使用后、释放后）</b></div><div>1 内存未分配成功，却使用了它。</div><div>解决方法：</div><div>如果指针p是函数参数，那么在函数的入口处用 assert( p != NULL)</div><div>如果是用malloc或new来申请内存，应该用if(p == NULL) 或if(p != NULL)进行防错处理</div><div>区别：</div><div>assert这个宏只是帮助我们调试代码的，它的作用是：让用户在调试函数的时候把错误排除掉，而不是等待Release之后。assert可以<strong>帮助定位错误</strong>，而不是排除错误</div><div>if(NULL!=p)是在Release版本中检验指针的有效性。</div><div><br/></div><div>2 内存分配成功，但尚未初始化就引用它</div><div><br/></div><div>3 内存分配成功，已初始化，但操作越界</div><div><br/></div><div>4 忘记释放内存，造成内存泄露</div><div><br/></div><div>5 释放了内存却继续使用</div><div>情形一：写错了函数的return语句，不要返回指向“栈内存”的指针 或者“引用”</div><div>情形二：使用free 或 delete释放了内存后，没有将指针设为NULL，<b>导致产生野指针</b></div><div><b>delete或free一块内存后，若没NULL，<font color="#FF0000">继续使用不会报错</font>，但是取到的是垃圾内存。     </b></div><div><b><br/></b></div><div><b>new，delete，malloc，free：</b></div><div> malloc与free是C++/C语言的标准库函数，new/delete是C++的运算符。它们都可用于申请动态内存和释放内存。<br/><br/>
对于非内部数据类型的对象而言，光用maloc/free<b>无法满足动态对象的要求</b>。对象在创建的同时要自动执行构造函数，对象在消亡之前要自动执行析构函 数。由于malloc/free是库函数而不是运算符，<b><font color="#FF0000">不在编译器控制权限之内，不能够把执行构造函数和析构函数的任务强加于malloc/free</font></b>。<br/><br/>
因此C++语言需要一个能完成动态内存分配和初始化工作的运算符new，以及一个能完成清理与释放内存工作的运算符delete。注意new/delete不是库函数。</div><div> 所以我们不要企图用malloc/free来完成动态对象的内存管理，应该用new/delete。由于内部数据类型的“对象”没有构造与析构的过程，对它们而言malloc/free和new/delete是等价的。<br/><br/>
既然new/delete的功能完全覆盖了malloc/free，为什么C++不把malloc/free淘汰出局呢？这是因为C++程序经常要<b>调用C函数，而C程序只能用malloc/free管理动态内存</b>。<br/><b>如果用free释放“new创建的动态对象”，那么该对象因无法执行析构函数而可能导致程序出错。如果用delete释放“malloc申请的动态内存”， 理论上讲程序不会出错，但是该程序的可读性很差。</b>所以new/delete必须配对使用，malloc/free也一样。 </div><div><br/></div><div>指针和数组的比较</div><div>int* a = new a[3];</div><div>如果a是全局变量中，那么a就在数据区；</div><div>如果a是局部变量，那么a就在栈区，</div><div>不管a是全局变量还是局部变量，它所指的分配区域（也就是new出来的空间）是在堆上。</div><div><b>int a[3]；</b></div><div><b>如果a是全局变量中，那么a就在数据区；</b></div><div><b>如果a是局部变量，那么a就在栈区。</b></div><div>区别：</div><div>1 不能对数组名进行直接赋值，其相当于为const变量</div><div>2 sizeof计算数组名 和指针名的 大小</div><div><b><br/></b></div><div>指针参数是怎样传递内存的</div><div>1 用指针的指针  记住 <b><font color="#FF0000">单一传递指针时，实际是指针的拷贝</font></b></div><div>2 用返回类型，但不要返回局部指针（即指向栈中的）</div><div><b><br/></b></div><div>非C++内建类型A 和B，在哪几种情况下B 能隐式转化为A？【较难】<br/>
答：<br/>
b）class B{operator A();}//B 实现了隐式转化为A 的转化<br/>
c）class A{ A(const B&amp;);}//A 实现了non-explicit 的参数为B 构造函数<br/>
(可以有其他带带默认值的参数)<br/>
d）A&amp; operator= (const B&amp;);//赋值操作，虽不是正宗的隐式类型转换，<br/>
但也可以勉强算一个</div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//题目：写一个智能指针类(smart_ptr)。</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/*要点</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">1 获得各种指针的行为的控制权：</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">（1）构造和析构：避免指针未初始化；消除资源泄露</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">（2）复制和赋值：深拷贝&amp;浅拷贝；还是不能拷贝</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">（3）解引用：</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">*/</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/////////////////////////////////////////////////////////////////////////////方案一</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/*类似auto_ptr的实现，当对象被复制或赋值时，转移“对象拥有权”，对象所有权是独占性的！</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">但是在利用这种智能指针时，尽可能用传pass-by-reference-to-const*/</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/*template用来产生smart pointer objects*/</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SmartPtr{</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">public</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//注意哪些地方用类型T！！</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          SmartPtr(T *realPtr = NULL);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          ~SmartPtr();</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//若不想被拷贝可设为私有 </span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          SmartPtr(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SmartPtr&lt;T&gt; &amp;rhs);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          SmartPtr&lt;T&gt;&amp;</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">=(SmartPtr&lt;T&gt; &amp;rhs);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          T*</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">-&gt;()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;                                     </span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//返回值为T* 及const;因为编译器的转化原因</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//Smartptr&lt;T&gt; sp; sp-&gt;fun() ==&gt; (sp.operator-&gt;())-&gt;fun();</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          T&amp;</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//虽然解引用所指之物可能改变，但指针本身不会变</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//返回引用也是必要的，因为psrc有可能是指向派生类对象的</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">private</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          T *psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">};</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//确定一个目标物</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SmartPtr&lt;T&gt;::SmartPtr(T *realPtr):psrc(realPtr){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SmartPtr&lt;T&gt;::~SmartPtr(){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//                 </span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SmartPtr&lt;T&gt;::SmartPtr(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SmartPtr&lt;T&gt; &amp;rhs){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          psrc = rhs.psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          rhs.psrc = NULL;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SmartPtr&lt;T&gt;&amp; SmartPtr&lt;T&gt;::</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">=(SmartPtr&lt;T&gt; &amp;rhs){</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//这里不要加const</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//对象拥有权转移实现</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">== &amp;rhs)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          psrc = rhs.psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          rhs.psrc = NULL;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; SmartPtr&lt;T&gt;::</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T* SmartPtr&lt;T&gt;::</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">-&gt;()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">////////////////////////////////////////////////////////////////////////////方案二</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/*类似shared_ptr的实现，当对象被复制或赋值时，改变引用计数的值</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">1 当引入引用计数shared_count变量时，这个变量应该放哪里？？</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">          （1）若该变量是智能指针类的一部分，那么每一个智能指针对象都要知道</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">          其它对象的位置，这样才能更新shared_count</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">          （2）若是指向对象的一部分，得修改原来已写好的对象类</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">解决办法：</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">          （1）重新创建一个新类，包装对象与计数量</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">          （2）将计数量声明为指针类型，放于智能指针类中，这样每个智能指针对象对其都可见</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">*/</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;     </span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr{</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">public</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">explicit</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr(T *realPtr = 0);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          ~SharedPtr();</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          SharedPtr(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt; &amp;rhs);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          SharedPtr&lt;T&gt;&amp;</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">=(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt; &amp;rhs);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          T&amp;</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          T*</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">-&gt;()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">private</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          T *psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*sharedCount;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">};</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt;::SharedPtr(T *realPtr):psrc(realPtr),sharedCount(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(1)){}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt;::~SharedPtr(){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(--*sharedCount == 0){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   psrc = NULL;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">sharedCount;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   sharedCount = NULL;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt;::SharedPtr(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt; &amp;rhs):</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">sharedCount(rhs.sharedCount),</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">psrc(rhs.psrc){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          ++*sharedCount;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt;&amp; SharedPtr&lt;T&gt;::</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">=(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">SharedPtr&lt;T&gt; &amp;rhs){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">= &amp;rhs)</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//先看看自己是不是最后一个指向当前对象的</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(--*sharedCount == 0){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">sharedCount;sharedCount=NULL;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">psrc;psrc=NULL;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//别忘了对先对象引用计数++</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          ++*rhs.sharedCount;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          sharedCount = rhs.sharedCount;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          psrc = rhs.sharedCount;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; SharedPtr&lt;T&gt;::</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(*sharedCount)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*psrc;</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//注意这里返回的不是SharedPtr的对象</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">throw</span></font> <font color="#A31515" face="Times New Roman" size="4"><span style="font-size:14pt">&quot;null ptr error&quot;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T* SharedPtr&lt;T&gt;::</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">-&gt;()</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(*sharedCount)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">psrc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">throw</span></font> <font color="#A31515" face="Times New Roman" size="4"><span style="font-size:14pt">&quot;null ptr error&quot;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">////////////////////////////////////单例销毁问题</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//除了单例单例4实现，其他都要进行手工释放</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//一种自动销毁的实现</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Singleton5</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">private</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          Singleton5(){}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">static</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Singleton5* instance;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//单例实例的回收</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">GC</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          {</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//注意析构函数要为public</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">public</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   ~GC()</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   {</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(instance != NULL)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             {</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                                      </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">instance;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                                      instance = NULL;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          };</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">public</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">static</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Singleton5* getInstance()</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          {</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">instance;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//ge对象销毁时，销毁单例对象</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">static</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">GC gc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">};</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Singleton5* Singleton5::instance =</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Singleton5();</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Singleton5::GC Singleton5::gc;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//自动垃圾回收另一种实现</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//http://hi.baidu.com/qinfengxiaoyue/item/48a792020301c870bfe97ea6 </span></font></div></div><div><b><br/></b></div><div><hr/><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">public</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          String(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">char</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*str=NULL);</span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//构造函数</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          String(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String &amp;other);</span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//拷贝构造函数</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          ~String(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">);</span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//析构函数</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          String&amp;</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">=(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String &amp;other);</span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//等号操作符重载</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">private</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">char</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*m_data;</span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//指针</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">};</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String::~String()</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[] m_data;</span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//析构函数，释放地址空间</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String::String(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">char</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*str)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(str==NULL)</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//当初始化串不存在的时候，为m_data申请一个空间存放'\0'；</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          {</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   m_data=</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">char</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[1];</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   *m_data=</span></font> <font color="#A31515" face="Times New Roman" size="4"><span style="font-size:14pt">'\0'</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">else</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//当初始化串存在的时候，为m_data申请同样大小的空间存放该串；</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          {</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">length=strlen(str);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   m_data=</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">char</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[length+1];</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   strcpy(m_data,str);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String::String(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String &amp;other)</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//拷贝构造函数，功能与构造函数类似。</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">length=strlen(other.m_data);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          m_data=</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">char</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[length+1];</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          strcpy(m_data,other.m_data);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String&amp; String::</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">=(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">String &amp;other)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">==&amp;other)</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//当地址相同时，直接返回；</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[] m_data;</span></font><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//当地址不相同时，删除原来申请的空间，重新开始构造；</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">length= strlen (other.m_data);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          m_data=</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">char</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[length+1];</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          strcpy(m_data,other.m_data);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">*</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">this</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">}</span></font></div></div><div><hr/></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">template</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">typename</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">class</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Vector{</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">public</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//内嵌类型</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">typedef</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T value_type;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">typedef</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">value_type* pointer;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">typedef</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">value_type&amp; reference;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">typedef</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">value_type* iterator;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">typedef</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">size_t size_type;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">typedef</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">ptrdiff_t difference_type;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//构造函数，赋值函数</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          Vector():start(0),finish(0),end_of_storage(0){}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          Vector(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">n,</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; value){fill_initialize(n,value);}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          Vector(</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">long</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">n,</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; value){fill_initialize(n,value);}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">explicit</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Vector(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">n){fill_initialize(n,T())}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Vector&lt;T&gt;&amp;</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">=(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Vector&lt;T&gt;&amp; rhs){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/*</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   1 先判断是否为同一个对象</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   2 判断两个vector的空间关系</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                             rhs是否为空==》直接clear()</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                             rhs是否比左边的size()空间小==》拷贝，删除，更新finish、end_of_storage</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                             rhs是否比左边的capacity()空间小==》先拷贝，删除，更新finish、end_of_storage</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                             rhs是否比左边的大==》删除原来的，重新分配，拷贝，更新</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   */</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//插入、删除、访问</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">insert(iterator position,size_type n,</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; x){};</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">push_back(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; x){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(finish != end_of_storage){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(finish) T(x);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             ++finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   }</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">else</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             insert_aux(x);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">pop_back(){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   --finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          iterator erase(iterator position){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//删除Position指向的元素</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/*</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   1 若Position所指元素为最后一个</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   2 若Position所指向中间的结点，则先移动元素，变成第一种情况</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   */</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(position + 1 == end()){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">for</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(iterator it = position;it != end()-1;++it)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                                      *it = *(it+1);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   --finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">position;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          iterator erase(iterator first,iterator last){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//删除[first,last)里的元素</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">/*</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   1 拷贝、移动</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   2 删除[it,finish)</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   3 调整finish指针</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   4 返回</span></font></div><div align="left"><font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">                   */</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(first == NULL)</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">first;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   iterator it = copy(last,finish,first);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">for</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(iterator t = it;t != finish;++t)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(it != NULL)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                                      </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">it;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   finish = it;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">first;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">clear(){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   erase(begin(),end());</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          reference</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">operator</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[](size_type n){*(begin()+n);}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//三个迭代器简单应用</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          iterator begin(){</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">start;}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          iterator end(){</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">finish;}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          size_type size(){</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">return</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">size_type(end()-begin());}</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//其它操作</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">resize(size_type new_size){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">if</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(new_size &lt; size()){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             erase(begin()+new_size,end());</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   }</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">else</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">{</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             insert(end(),new_size-size(),T());</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">protected</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//辅助函数</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">fill_initialize(size_type n,</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; value){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   start =</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T[n];</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   iterator tmp = start;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">for</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">int</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">i = 0;i &lt; n;i++){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(tmp) T(value);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             ++tmp;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   finish = start + n;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   end_of_storage = finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">insert_aux(</span></font><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T&amp; x){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">size_type oldsize = size();</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">const</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">size_type len = oldsize != 0 ? 2*oldsize : 1;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//配置新空间</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   iterator new_start =</span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">T[len];</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   iterator new_finish = new_start;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//拷贝元素</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   new_finish = copy(begin(),end(),new_start);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">new</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">(new_finish) T(x);</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   ++new_finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//没有考虑insert（）函数插入带来的空间不足的处理</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//删除原来的</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   destroy(begin(),end());</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//调整 start，finish，end_of_storage</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   start = new_start;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   finish = new_finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   end_of_storage = new_start + len;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">void</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">destroy(iterator first,iterator last){</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                   </span></font> <font color="#008000" face="Times New Roman" size="4"><span style="font-size:14pt">//for(iterator it=first;it != last;++it)</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">                             </span></font> <font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">delete</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">[] first;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">protected</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          iterator start;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          iterator finish;</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">          iterator end_of_storage;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="4"><span style="font-size:14pt">private</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">:</span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">};</span></font></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b><br/></b></div></div></div></div>
</div></body></html> 